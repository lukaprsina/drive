(this.webpackJsonpsim=this.webpackJsonpsim||[]).push([[0],{30:function(r,e,t){},32:function(r,e,t){"use strict";t.r(e);var n=t(2),a=t(1),o=t.n(a),c=t(20),d=t.n(c),s=t(23),i=t(34),f=(t(30),t(10)),l=t(5),u=t(22),m=t(4),b=t(35),g={offsetBottom:function(r,e){return L(e,r.first)},offsetTop:function(r,e){return L(e,r.last)},halfRoadLeft:function(r,e){return B(e.roadWidth/2,r.angle-90)},halfRoadRight:function(r,e){return B(e.roadWidth/2,r.angle+90)},laneBottomLeft:function(r,e,t){return L(g.halfRoadLeft(e,t),g.offsetBottom(r,t))},laneTopLeft:function(r,e,t){return L(g.halfRoadLeft(e,t),g.offsetTop(r,t))},laneBottomRight:function(r,e,t){return L(g.halfRoadRight(e,t),g.offsetBottom(r,t))},laneTopRight:function(r,e,t){return L(g.halfRoadRight(e,t),g.offsetTop(r,t))},roadBottomLeft:function(r,e){return L(L(r.backward[0].first,e),g.halfRoadLeft(r,e))},roadBottomRight:function(r,e){return L(L(r.forward[r.forward.length-1].first,e),g.halfRoadRight(r,e))},roadTopLeft:function(r,e){return L(L(r.backward[0].last,e),g.halfRoadLeft(r,e))},roadTopRight:function(r,e){return L(L(r.forward[r.forward.length-1].last,e),g.halfRoadRight(r,e))},roadTopMiddle:function(r,e){return L(B(e.roadLength,r.angle),L(B((r.numberOfForward+r.numberOfBackward)*e.roadWidth/2,r.angle+90),g.roadBottomLeft(r,e)))}};function h(r){if(!r||!r.length)return null;var e,t="",n=Object(m.a)(r);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(t+=a.letter+" ",a.coords){var o,c=Object(m.a)(a.coords);try{for(c.s();!(o=c.n()).done;){var d=o.value;t+=d.x+" "+d.y+" "}}catch(s){c.e(s)}finally{c.f()}}}}catch(s){n.e(s)}finally{n.f()}return t}function j(r){var e=r.string,t=r.side,a=r.index,o=r.indexRoad,c=r.accept,d=r.onDrop,s=Object(b.a)({accept:c,drop:function(r,e){return d(r,e,a,o)}}),i=Object(l.a)(s,2)[1];return Object(n.jsx)("path",{ref:i,d:e,className:t+"-asphalt"},a)}function v(r){var e=r.points,t=r.coordInfo,a=r.disabled;if(!e||!t||void 0!==a&&a)return null;for(var o={strings:{forward:[],backward:[]},elements:{}},c=function(){var r,a=s[d],c=Object(m.a)(e);try{for(c.s();!(r=c.n()).done;){var i,f=r.value,l=Object(m.a)(f[a]);try{for(l.s();!(i=l.n()).done;){var u=i.value;o.strings[a].push([g.offsetBottom(u,t),g.offsetTop(u,t)])}}catch(b){l.e(b)}finally{l.f()}}}catch(b){c.e(b)}finally{c.f()}o.elements[a]=o.strings[a].map((function(r,e){return Object(n.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:a+"-debug"},e)}))},d=0,s=["forward","backward"];d<s.length;d++)c();return Object(n.jsxs)("g",{children:[o.elements.forward,o.elements.backward]})}function p(r){var e=r.points,t=r.coordInfo;if(!e||!t)return null;for(var a={elements:{},strings:{continous:[],striped:[]}},o=0,c=["forward","backward"];o<c.length;o++){var d,s=c[o],i=Object(m.a)(e);try{for(i.s();!(d=i.n()).done;){var f,u=d.value,b=Object(m.a)(u[s].entries());try{for(b.s();!(f=b.n()).done;){var h=Object(l.a)(f.value,2),j=h[0],v=h[1];j===u[s].length-1&&"backward"!==s||(j===u[s].length-1&&"backward"===s?a.strings.continous.push([g.laneBottomRight(v,u,t),g.laneTopRight(v,u,t)]):a.strings.striped.push([g.laneBottomRight(v,u,t),g.laneTopRight(v,u,t)]))}}catch(p){b.e(p)}finally{b.f()}}}catch(p){i.e(p)}finally{i.f()}}return a.elements.continous=a.strings.continous.map((function(r,e){return Object(n.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:"line"},e)})),a.elements.striped=a.strings.striped.map((function(r,e){return Object(n.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:"line",strokeDasharray:"30, 60"},e)})),Object(n.jsxs)("g",{children:[a.elements.continous,a.elements.striped]})}function O(r){var e=r.points,t=r.coordInfo,a=r.rotateBind;if(!(e&&t&&a))return null;var o,c={strings:[]},d=Object(m.a)(e);try{for(d.s();!(o=d.n()).done;){var s=o.value;c.strings.push({vectors:g.roadTopMiddle(s,t),order:s.order})}}catch(i){d.e(i)}finally{d.f()}return c.elements=c.strings.map((function(r,e){return Object(n.jsx)("circle",Object(f.a)({cx:r.vectors.x,cy:r.vectors.y,r:"10",className:"rotate"},a(r.order)),e)})),Object(n.jsx)("g",{children:c.elements})}function x(r){var e=r.points,t=r.coordInfo,a=r.addLanes;if(!e||!t)return null;var o,c={strings:{forward:{remove:[],add:[]},backward:{remove:[],add:[]}},elements:{forward:{remove:[],add:[]},backward:{remove:[],add:[]}}},d=Object(m.a)(e);try{for(d.s();!(o=d.n()).done;){var s=o.value;c.strings.forward.remove.push(L(g.roadBottomLeft(s,t),B(t.roadLength/3,s.angle))),c.strings.forward.add.push(L(g.roadBottomLeft(s,t),B(2*t.roadLength/3,s.angle))),c.strings.backward.remove.push(L(g.roadBottomRight(s,t),B(t.roadLength/3,s.angle))),c.strings.backward.add.push(L(g.roadBottomRight(s,t),B(2*t.roadLength/3,s.angle)))}}catch(i){d.e(i)}finally{d.f()}return c.elements.forward.remove=c.strings.forward.remove.map((function(r,e){return Object(n.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return a(e,"Forward",-1)}},e)})),c.elements.forward.add=c.strings.forward.add.map((function(r,e){return Object(n.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return a(e,"Forward",1)}},e)})),c.elements.backward.remove=c.strings.backward.remove.map((function(r,e){return Object(n.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return a(e,"Backward",-1)}},e)})),c.elements.backward.add=c.strings.backward.add.map((function(r,e){return Object(n.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return a(e,"Backward",1)}},e)})),Object(n.jsxs)("g",{children:[c.elements.forward.remove,c.elements.forward.add,c.elements.backward.remove,c.elements.backward.add]})}function w(r){var e=r.points,t=r.coordInfo;if(!e||!t)return null;var a={};a.string=h([{letter:"M",coords:[g.roadBottomLeft(e[0],t)]}]);var o,c=Object(m.a)(e);try{for(c.s();!(o=c.n()).done;){var d=o.value;a.string+=h([{letter:"L",coords:[g.roadBottomLeft(d,t),g.roadBottomRight(d,t)]}])}}catch(s){c.e(s)}finally{c.f()}return a.element=Object(n.jsx)("path",{d:a.string,className:"center"}),a.element}function y(r){var e=r.points,t=r.coordInfo;if(!e||!t)return null;var a={};a.string=h([{letter:"M",coords:[g.roadBottomLeft(e[0],t)]}]);var o,c=Object(m.a)(e.entries());try{for(c.s();!(o=c.n()).done;){var d=Object(l.a)(o.value,2),s=d[0],i=d[1];a.string+=h([{letter:"L",coords:[g.roadBottomLeft(i,t),g.roadTopLeft(i,t)]},{letter:"M",coords:[g.roadTopRight(i,t)]},{letter:"L",coords:[g.roadBottomRight(i,t)]}]),s===e.length-1&&(a.string+=h([{letter:"L",coords:[g.roadBottomLeft(e[0],t)]}]))}}catch(f){c.e(f)}finally{c.f()}return a.element=Object(n.jsx)("path",{d:a.string,className:"curb"}),a.element}function k(){var r=Object(a.useRef)(),e=Object(a.useState)({}),t=Object(l.a)(e,2),o=t[0],c=t[1],d=Object(a.useState)([{numberOfBackward:1,numberOfForward:2,angle:0,order:0},{numberOfBackward:1,numberOfForward:1,angle:110,order:1},{numberOfBackward:2,numberOfForward:3,angle:170,order:2},{numberOfBackward:1,numberOfForward:1,angle:300,order:3}]),s=Object(l.a)(d,2),i=s[0],b=s[1],k=Object(u.a)((function(r){var e=r.event,t=Object(l.a)(r.args,1)[0];if(e.x&&e.y){var n=L(e,function(r,e){var t=r.x*e,n=r.y*e;return{x:t,y:n}}(o,-1)),a=Math.atan2(n.y,n.x)*(180/Math.PI);(a%=360)<0&&(a+=360);var c=i.map((function(r){return Object(f.a)({},r)}));c.sort((function(r,e){return r.angle-e.angle}));for(var d=0;d<c.length;d++)t===c[d].order&&(c[d].angle=a);b(c)}}));Object(a.useEffect)((function(){function e(){var e=function(r,e){if(!r.current)return null;var t=r.current.getBoundingClientRect(),n=(t.right-t.left)/2,a=(t.bottom-t.top)/2,o=Math.max.apply(Math,e.map((function(r){return r.numberOfForward+r.numberOfBackward}))),c=Math.min(n,a);return{x:n,y:a,roadLength:c/2,roadWidth:c/o*.5,maxRoadWidth:o}}(r,i);c(e)}return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[r,i]);var R=function(r,e){var t=[];if(!(e&&e.roadLength&&e.roadWidth))return null;for(var n=0;n<r.length;n++){var a=r[n],o=(a.numberOfForward+a.numberOfBackward-1)*e.roadWidth/2;t[n]={forward:[],backward:[],maxDistance:o,angle:a.angle,order:a.order,numberOfForward:a.numberOfForward,numberOfBackward:a.numberOfBackward};for(var c=a.numberOfForward+a.numberOfBackward,d=0;d<c;d++){var s=L(B(o-d*e.roadWidth,a.angle-90),B(e.maxRoadWidth*e.roadWidth*.7,a.angle)),i=L(s,B(e.roadLength,a.angle));d>=a.numberOfForward?t[n].forward.push({first:s,last:i}):t[n].backward.push({first:s,last:i})}}return t}(i,o);var I=function(r){var e=r.points,t=r.coordInfo,a=r.handleDrop;if(!e||!t)return null;var o,c=[],d=Object(m.a)(e.entries());try{var s=function(){for(var r=Object(l.a)(o.value,2),e=r[0],d=r[1],s=[],i=0,f=["forward","backward"];i<f.length;i++){var u,b=f[i],v=Object(m.a)(d[b]);try{for(v.s();!(u=v.n()).done;){var p=u.value;s.push(h([{letter:"M",coords:[g.offsetBottom(p,t)]},{letter:"L",coords:[g.laneBottomLeft(p,d,t),g.laneTopLeft(p,d,t),g.laneTopRight(p,d,t),g.laneBottomRight(p,d,t)]},{letter:"Z"}]))}}catch(O){v.e(O)}finally{v.f()}}c.push(Object(n.jsx)("g",{children:s.map((function(r,t){return Object(n.jsx)(j,{string:r,side:"backward",index:t,indexRoad:e,accept:"sign",onDrop:function(r,n){return a(r,n,t,e)}},t)}))},e))};for(d.s();!(o=d.n()).done;)s()}catch(i){d.e(i)}finally{d.f()}return c}({points:R,coordInfo:o,handleDrop:function(r,e,t,n){console.log(r,e),console.log({index:t,indexRoad:n})}});return Object(n.jsx)("div",{style:{touchAction:"none"},children:Object(n.jsxs)("svg",{className:"artboard",ref:r,children:[Object(n.jsx)("g",{children:I}),Object(n.jsx)(w,{points:R,coordInfo:o}),Object(n.jsx)(y,{points:R,coordInfo:o}),Object(n.jsx)(p,{points:R,coordInfo:o}),Object(n.jsx)(v,{points:R,coordInfo:o,disabled:!0}),Object(n.jsx)(O,{points:R,coordInfo:o,rotateBind:k}),Object(n.jsx)(x,{points:R,coordInfo:o,addLanes:function(r,e,t){var n=i.map((function(r){return Object(f.a)({},r)}));(n[r]["numberOf"+e]>1||t>0)&&(n[r]["numberOf"+e]+=t),b(n)}})]})})}function B(r,e){var t=e*Math.PI/180;return{x:r*Math.cos(t),y:r*Math.sin(t)}}function L(r,e){return{x:r.x+e.x,y:r.y+e.y}}var R=t(36),I=t.p+"static/media/forward.fc55a6c4.svg",T=t.p+"static/media/give way.db0b54fd.svg",M=t.p+"static/media/left.1aa9e07d.svg",N=t.p+"static/media/right.ff8f1205.svg",F=t.p+"static/media/stop.4938481c.svg",W=t.p+"static/media/priority.1971fe2a.svg";function D(){var r=[I,T,M,N,F,W].map((function(r,e){return Object(n.jsx)(C,{src:r,index:e},e)}));return Object(n.jsx)("div",{className:"inventory",children:r})}function C(r){var e=r.src,t=r.index,a=Object(R.a)({item:{id:t,type:"sign"}}),o=Object(l.a)(a,2),c=(o[0],o[1]);return Object(n.jsx)("div",{className:"drag",ref:c,children:Object(n.jsx)("img",{src:e,className:"sign",alt:e,draggable:!1})})}function E(){return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(D,{}),Object(n.jsx)(k,{})]})}d.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(i.a,{backend:s.a,children:Object(n.jsx)(E,{})})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.b30e42d5.chunk.js.map