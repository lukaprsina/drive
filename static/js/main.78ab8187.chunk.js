(this.webpackJsonpsim=this.webpackJsonpsim||[]).push([[0],{41:function(r,e,t){},49:function(r,e,t){"use strict";t.r(e);var a=t(2),n=t(0),o=t.n(n),c=t(9),s=t.n(c),d=t(32),i=t(64),f=(t(41),t(3)),l=t(4),u=t(27),b=t(33),v=t(66);function m(r){var e=r.accept,t=r.onDrop,n=r.indexRoad,o=r.children,c=r.side,s=Object(v.a)({accept:e,drop:"forward"===c?function(r){return t(r,n)}:null}),d=Object(l.a)(s,2)[1];return Object(a.jsx)("g",{ref:d,children:o})}function g(r){var e=r.string,t=r.indexLane,n=r.indexRoad,o=r.accept,c=r.onDrop,s=r.side,d=Object(v.a)({accept:o,drop:"forward"===s?function(r){return c(r,n,t)}:null}),i=Object(l.a)(d,2)[1];return Object(a.jsx)("path",{ref:i,d:e,className:"asphalt"},t)}function h(r){var e=r.points,t=r.coordInfo,n=r.disabled,o=void 0!==n&&n,c=r.vectors;if(!e||!t||o)return null;for(var s={strings:{forward:[],backward:[]},elements:{}},d=function(){var r,n=l[i],o=Object(f.a)(e);try{for(o.s();!(r=o.n()).done;){var d,u=r.value,b=Object(f.a)(u[n]);try{for(b.s();!(d=b.n()).done;){var v=d.value;s.strings[n].push([c.offsetBottom(v,t),c.offsetTop(v,t)])}}catch(m){b.e(m)}finally{b.f()}}}catch(m){o.e(m)}finally{o.f()}s.elements[n]=s.strings[n].map((function(r,e){return Object(a.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:n+"-debug"},e)}))},i=0,l=["backward","forward"];i<l.length;i++)d();return Object(a.jsxs)("g",{children:[s.elements.forward,s.elements.backward]})}function j(r){var e=r.points,t=r.coordInfo,n=r.disabled,o=void 0!==n&&n,c=r.vectors;if(!e||!t||o)return null;for(var s={elements:{},strings:{continous:[],striped:[]}},d=0,i=["backward","forward"];d<i.length;d++){var u,b=i[d],v=Object(f.a)(e);try{for(v.s();!(u=v.n()).done;){var m,g=u.value,h=Object(f.a)(g[b].entries());try{for(h.s();!(m=h.n()).done;){var j=Object(l.a)(m.value,2),O=j[0],p=j[1];O===g[b].length-1&&"forward"!==b||(O===g[b].length-1&&"forward"===b?s.strings.continous.push([c.laneBottomRight(p,g,t),c.laneTopRight(p,g,t)]):s.strings.striped.push([c.laneBottomRight(p,g,t),c.laneTopRight(p,g,t)]))}}catch(x){h.e(x)}finally{h.f()}}}catch(x){v.e(x)}finally{v.f()}}return s.elements.continous=s.strings.continous.map((function(r,e){return Object(a.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:"line"},e)})),s.elements.striped=s.strings.striped.map((function(r,e){return Object(a.jsx)("line",{x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y,className:"line",strokeDasharray:"30, 60"},e)})),Object(a.jsxs)("g",{children:[s.elements.continous,s.elements.striped]})}function O(r){var e=r.points,t=r.coordInfo,n=r.disabled,o=void 0!==n&&n,c=r.vectors,s={strings:[]};if(!e||!t||o)return null;var d,i=Object(f.a)(e.entries());try{for(i.s();!(d=i.n()).done;){var u,b=Object(l.a)(d.value,2),v=b[0],m=b[1],g=Object(f.a)(m.forward);try{for(g.s();!(u=g.n()).done;){var h,j=u.value,O=Object(f.a)(e.entries());try{for(O.s();!(h=O.n()).done;){var p=Object(l.a)(h.value,2),x=p[0],w=p[1];if(v!==x){var y,k=Object(f.a)(w.backward);try{for(k.s();!(y=k.n()).done;){var B=y.value;s.strings.push(N([{letter:"M",coords:[c.offsetBottom(j,t)]},{letter:"Q",coords:[t,I(B.first,t)]}]))}}catch(L){k.e(L)}finally{k.f()}}}}catch(L){O.e(L)}finally{O.f()}}}catch(L){g.e(L)}finally{g.f()}}}catch(L){i.e(L)}finally{i.f()}return s.elements=s.strings.map((function(r,e){return Object(a.jsx)("path",{d:r,className:"curve"},e)})),Object(a.jsx)("g",{children:s.elements})}function p(r){var e=r.points,t=r.coordInfo,n=r.rotateBind,o=r.disabled,c=void 0!==o&&o,s=r.vectors;if(!(e&&t&&n)||c)return null;var d,i={strings:[]},l=Object(f.a)(e);try{for(l.s();!(d=l.n()).done;){var u=d.value;i.strings.push({vectors:s.roadTopMiddle(u,t),order:u.order})}}catch(v){l.e(v)}finally{l.f()}return i.elements=i.strings.map((function(r,e){return Object(a.jsx)("circle",Object(b.a)({cx:r.vectors.x,cy:r.vectors.y,r:"10",className:"rotate"},n(r.order)),e)})),Object(a.jsx)("g",{children:i.elements})}function x(r){var e=r.points,t=r.coordInfo,n=r.addLanes,o=r.disabled,c=void 0!==o&&o,s=r.vectors;if(!e||!t||c)return null;var d,i={strings:{forward:{remove:[],add:[]},backward:{remove:[],add:[]}},elements:{forward:{remove:[],add:[]},backward:{remove:[],add:[]}}},l=Object(f.a)(e);try{for(l.s();!(d=l.n()).done;){var u=d.value;i.strings.forward.remove.push(I(s.roadBottomLeft(u,t),R(t.roadLength/3,u.angle))),i.strings.forward.add.push(I(s.roadBottomLeft(u,t),R(2*t.roadLength/3,u.angle))),i.strings.backward.remove.push(I(s.roadBottomRight(u,t),R(t.roadLength/3,u.angle))),i.strings.backward.add.push(I(s.roadBottomRight(u,t),R(2*t.roadLength/3,u.angle)))}}catch(b){l.e(b)}finally{l.f()}return i.elements.forward.remove=i.strings.forward.remove.map((function(r,e){return Object(a.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return n(e,"Forward",-1)}},e)})),i.elements.forward.add=i.strings.forward.add.map((function(r,e){return Object(a.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return n(e,"Forward",1)}},e)})),i.elements.backward.remove=i.strings.backward.remove.map((function(r,e){return Object(a.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return n(e,"Backward",-1)}},e)})),i.elements.backward.add=i.strings.backward.add.map((function(r,e){return Object(a.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"add-lane",onClick:function(){return n(e,"Backward",1)}},e)})),Object(a.jsxs)("g",{children:[i.elements.forward.remove,i.elements.forward.add,i.elements.backward.remove,i.elements.backward.add]})}function w(r){var e=r.points,t=r.coordInfo,n=r.disabled,o=void 0!==n&&n,c=r.vectors;if(!e||!t||o)return null;var s={};s.string=N([{letter:"M",coords:[c.roadBottomLeft(e[0],t)]}]);var d,i=Object(f.a)(e);try{for(i.s();!(d=i.n()).done;){var l=d.value;s.string+=N([{letter:"L",coords:[c.roadBottomLeft(l,t),c.roadBottomRight(l,t)]}])}}catch(u){i.e(u)}finally{i.f()}return s.element=Object(a.jsx)("path",{d:s.string,className:"center"}),s.element}function y(r){var e=r.points,t=r.coordInfo,n=r.disabled,o=void 0!==n&&n,c=r.vectors;if(!e||!t||o)return null;var s={};s.string=N([{letter:"M",coords:[c.roadBottomLeft(e[0],t)]}]);var d,i=Object(f.a)(e.entries());try{for(i.s();!(d=i.n()).done;){var u=Object(l.a)(d.value,2),b=u[0],v=u[1];s.string+=N([{letter:"L",coords:[c.roadBottomLeft(v,t),c.roadTopLeft(v,t)]},{letter:"M",coords:[c.roadTopRight(v,t)]},{letter:"L",coords:[c.roadBottomRight(v,t)]}]),b===e.length-1&&(s.string+=N([{letter:"L",coords:[c.roadBottomLeft(e[0],t)]}]))}}catch(m){i.e(m)}finally{i.f()}return s.element=Object(a.jsx)("path",{d:s.string,className:"curb"}),s.element}function k(r){var e,t=r.objectInfo,n=r.points,o=r.coordInfo,c={strings:[]},s={},d=Object(f.a)(t.entries());try{for(d.s();!(e=d.n()).done;){var i=Object(l.a)(e.value,2),u=i[0],b=i[1];if(0!==b.cars.length){var v,m=Object(f.a)(b.cars.entries());try{for(m.s();!(v=m.n()).done;){var g=Object(l.a)(v.value,2),h=g[0],j=g[1];if(j){var O,p=Object(f.a)(j.entries());try{for(p.s();!(O=p.n()).done;){var x=Object(l.a)(O.value,2),w=x[0];x[1];s=I(I(n[u].forward[h].first,o),R(o.roadWidth*(w+.5),n[u].angle)),c.strings.push(s)}}catch(y){p.e(y)}finally{p.f()}}}}catch(y){m.e(y)}finally{m.f()}}}}catch(y){d.e(y)}finally{d.f()}return c.elements=c.strings.map((function(r,e){return Object(a.jsx)("circle",{cx:r.x,cy:r.y,r:"10",className:"car"},e)})),c.elements}var B=t(43);function L(){var r=Object(n.useRef)(),e=Object(n.useState)({}),t=Object(l.a)(e,2),o=t[0],c=t[1],s=Object(n.useState)([{numberOfBackward:1,numberOfForward:2,angle:0,order:0},{numberOfBackward:1,numberOfForward:1,angle:110,order:1},{numberOfBackward:2,numberOfForward:3,angle:170,order:2},{numberOfBackward:1,numberOfForward:1,angle:300,order:3}]),d=Object(l.a)(s,2),i=d[0],b=d[1],v={offsetBottom:function(r,e){return I(e,r.first)},offsetTop:function(r,e){return I(e,r.last)},halfRoadLeft:function(r,e){return R(e.roadWidth/2,r.angle-90)},halfRoadRight:function(r,e){return R(e.roadWidth/2,r.angle+90)},laneBottomLeft:function(r,e,t){return I(v.halfRoadLeft(e,t),v.offsetBottom(r,t))},laneTopLeft:function(r,e,t){return I(v.halfRoadLeft(e,t),v.offsetTop(r,t))},laneBottomRight:function(r,e,t){return I(v.halfRoadRight(e,t),v.offsetBottom(r,t))},laneTopRight:function(r,e,t){return I(v.halfRoadRight(e,t),v.offsetTop(r,t))},roadBottomLeft:function(r,e){return I(I(r.forward[0].first,e),v.halfRoadLeft(r,e))},roadBottomRight:function(r,e){return I(I(r.backward[r.backward.length-1].first,e),v.halfRoadRight(r,e))},roadTopLeft:function(r,e){return I(I(r.forward[0].last,e),v.halfRoadLeft(r,e))},roadTopRight:function(r,e){return I(I(r.backward[r.backward.length-1].last,e),v.halfRoadRight(r,e))},roadTopMiddle:function(r,e){return I(R(e.roadLength,r.angle),I(R((r.numberOfForward+r.numberOfBackward)*e.roadWidth/2,r.angle+90),v.roadBottomLeft(r,e)))}},L=Object(u.a)((function(r){var e=r.event,t=Object(l.a)(r.args,1)[0];if(e.x&&e.y){var a=I(e,function(r,e){var t=r.x*e,a=r.y*e;return{x:t,y:a}}(o,-1)),n=Math.atan2(a.y,a.x)*(180/Math.PI);(n%=360)<0&&(n+=360);var c=B.cloneDeep(i);c.sort((function(r,e){return r.angle-e.angle}));for(var s=0;s<c.length;s++)t===c[s].order&&(c[s].angle=n);b(c)}}));Object(n.useEffect)((function(){function e(){var e=function(r,e){if(!r.current)return null;var t=r.current.getBoundingClientRect(),a=(t.right-t.left)/2,n=(t.bottom-t.top)/2,o=Math.max.apply(Math,e.map((function(r){return r.numberOfForward+r.numberOfBackward}))),c=Math.min(a,n);return{x:a,y:n,roadLength:c/2,roadWidth:c/o*.5,maxRoadWidth:o}}(r,i);c(e)}return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[r,i]);var M=function(r,e){var t=[];if(!(e&&e.roadLength&&e.roadWidth))return null;for(var a=0;a<r.length;a++){var n=r[a],o=(n.numberOfForward+n.numberOfBackward-1)*e.roadWidth/2;t[a]={forward:[],backward:[],maxDistance:o,angle:n.angle,order:n.order,numberOfForward:n.numberOfForward,numberOfBackward:n.numberOfBackward};for(var c=n.numberOfForward+n.numberOfBackward,s=(n.numberOfForward+n.numberOfBackward)*e.roadWidth/5,d=0;d<c;d++){var i=I(R(o-d*e.roadWidth,n.angle-90),I(R(e.maxRoadWidth*e.roadWidth,n.angle),R(s,n.angle-180))),f=I(i,R(e.roadLength,n.angle));d<n.numberOfForward?t[a].forward.push({first:i,last:f}):t[a].backward.push({first:i,last:f})}}return t}(i,o),T=Object(n.useState)([{cars:[],signs:[]},{cars:[],signs:[]},{cars:[],signs:[]},{cars:[],signs:[]}]),F=Object(l.a)(T,2),D=F[0],W=F[1];var C=function(r){var e=r.points,t=r.coordInfo,n=r.handleSignDrop,o=r.handleCarDrop,c=r.vectors,s=r.disabled;if(!e||!t||void 0!==s&&s)return null;var d,i={forward:[],backward:[]},u=Object(f.a)(e.entries());try{var b=function(){for(var r=Object(l.a)(d.value,2),e=r[0],s=r[1],u={forward:[],backward:[]},b=0,v=["backward","forward"];b<v.length;b++){var h,j=v[b],O=Object(f.a)(s[j]);try{for(O.s();!(h=O.n()).done;){var p=h.value;u[j].push(N([{letter:"M",coords:[c.offsetBottom(p,t)]},{letter:"L",coords:[c.laneBottomLeft(p,s,t),c.laneTopLeft(p,s,t),c.laneTopRight(p,s,t),c.laneBottomRight(p,s,t)]},{letter:"Z"}]))}}catch(k){O.e(k)}finally{O.f()}}for(var x=function(){var r=y[w];i[r].push(Object(a.jsx)(m,{indexRoad:e,accept:["sign"],side:r,onDrop:function(r){return n(r,e)},children:u[r].map((function(t,n){return Object(a.jsx)(g,{string:t,indexLane:n,indexRoad:e,accept:["car"],side:r,onDrop:function(r){return o(r,e,n)}},n)}))},e))},w=0,y=["backward","forward"];w<y.length;w++)x()};for(u.s();!(d=u.n()).done;)b()}catch(v){u.e(v)}finally{u.f()}return i}({points:M,coordInfo:o,handleSignDrop:function(r,e){var t=B.cloneDeep(D);t[e].signs||(t[e].signs=[]),t[e].signs.push(r.id),W(t)},handleCarDrop:function(r,e,t){var a=B.cloneDeep(D);a[e].cars[t]||(a[e].cars[t]=[]),a[e].cars[t].push(r.id),W(a)},vectors:v});if(C)var S=C.backward,E=C.forward;return Object(a.jsx)("div",{style:{touchAction:"none"},children:Object(a.jsxs)("svg",{className:"artboard",ref:r,children:[Object(a.jsxs)("g",{children:[S,E]}),Object(a.jsx)(w,{points:M,coordInfo:o,vectors:v}),Object(a.jsx)(y,{points:M,coordInfo:o,vectors:v}),Object(a.jsx)(j,{points:M,coordInfo:o,vectors:v}),Object(a.jsx)(O,{points:M,coordInfo:o,vectors:v,disabled:!0}),Object(a.jsx)(h,{points:M,coordInfo:o,disabled:!0,vectors:v}),Object(a.jsx)(p,{points:M,coordInfo:o,rotateBind:L,vectors:v}),Object(a.jsx)(x,{points:M,coordInfo:o,addLanes:function(r,e,t){var a=B.cloneDeep(i);(a[r]["numberOf"+e]>1||t>0)&&(a[r]["numberOf"+e]+=t),b(a)},vectors:v}),Object(a.jsx)(k,{objectInfo:D,coordInfo:o,points:M})]})})}function R(r,e){var t=e*Math.PI/180;return{x:r*Math.cos(t),y:r*Math.sin(t)}}function I(r,e){return{x:r.x+e.x,y:r.y+e.y}}function N(r){if(!r||!r.length)return null;var e,t="",a=Object(f.a)(r);try{for(a.s();!(e=a.n()).done;){var n=e.value;if(t+=n.letter+" ",n.coords){var o,c=Object(f.a)(n.coords);try{for(c.s();!(o=c.n()).done;){var s=o.value;t+=s.x+" "+s.y+" "}}catch(d){c.e(d)}finally{c.f()}}}}catch(d){a.e(d)}finally{a.f()}return t}var M=t(65),T=t(67),F=t.p+"static/media/forward.fc55a6c4.svg",D=t.p+"static/media/give way.db0b54fd.svg",W=t.p+"static/media/left.1aa9e07d.svg",C=t.p+"static/media/right.ff8f1205.svg",S=t.p+"static/media/stop.4938481c.svg",E=t.p+"static/media/priority.1971fe2a.svg";function z(){var r=[F,D,W,C,S,E].map((function(r,e){return Object(a.jsx)(P,{src:r,index:e},e)}));return Object(a.jsxs)("div",{className:"inventory",children:[r,Object(a.jsx)(J,{})]})}function J(){var r=Object(T.a)({item:{id:"car",type:"car"}}),e=Object(l.a)(r,2)[1];return Object(a.jsx)("div",{className:"drag",ref:e,children:Object(a.jsx)("div",{className:"item car-item",draggable:!1})})}function P(r){var e=r.src,t=r.index,n=Object(T.a)({item:{id:t,type:"sign"}}),o=Object(l.a)(n,2)[1];return Object(a.jsx)(M.a,{className:"drag",ref:o,children:Object(a.jsx)("img",{src:e,className:"item sign",alt:e,draggable:!1})})}function A(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(z,{}),Object(a.jsx)(L,{})]})}s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(i.a,{backend:d.a,children:Object(a.jsx)(A,{})})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.78ab8187.chunk.js.map