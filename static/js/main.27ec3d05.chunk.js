(this.webpackJsonpsim=this.webpackJsonpsim||[]).push([[0],{57:function(e,t,r){},64:function(e,t,r){"use strict";r.r(t);var a=r(4),n=r(1),o=r.n(n),s=r(20),c=r.n(s),d=(r(57),r(22)),l=r(8),i=r(35),f=r(23);function u(e){if(!e||!e.length)return null;var t,r="",a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(r+=n.letter+" ",n.coords){var o,s=Object(f.a)(n.coords);try{for(s.s();!(o=s.n()).done;){var c=o.value;r+=c.x+" "+c.y+" "}}catch(d){s.e(d)}finally{s.f()}}}}catch(d){a.e(d)}finally{a.f()}return r}function m(){var e=Object(n.useRef)(),t=Object(n.useState)({}),r=Object(l.a)(t,2),o=r[0],s=r[1],c=Object(n.useState)([{numberOfBackward:1,numberOfForward:2,angle:0,order:0},{numberOfBackward:1,numberOfForward:1,angle:110,order:1},{numberOfBackward:2,numberOfForward:3,angle:170,order:2},{numberOfBackward:1,numberOfForward:1,angle:300,order:3}]),m=Object(l.a)(c,2),h=m[0],w=m[1],p=Object(i.a)((function(e){var t=e.event,r=Object(l.a)(e.args,1)[0];if(t.x&&t.y){var a=g(t,function(e,t){var r=e.x*t,a=e.y*t;return{x:r,y:a}}(o,-1)),n=Math.atan2(a.y,a.x)*(180/Math.PI);(n%=360)<0&&(n+=360);var s=h.map((function(e){return Object(d.a)({},e)}));s.sort((function(e,t){return e.angle-t.angle}));for(var c=0;c<s.length;c++)r===s[c].order&&(s[c].angle=n);w(s)}}));Object(n.useEffect)((function(){function t(){var t=function(e,t){if(!e.current)return null;var r=e.current.getBoundingClientRect(),a=(r.right-r.left)/2,n=(r.bottom-r.top)/2,o=Math.max.apply(Math,t.map((function(e){return e.numberOfForward+e.numberOfBackward}))),s=Math.min(a,n);return{x:a,y:n,roadLength:s/2,roadWidth:s/o*.5,maxRoadWidth:o}}(e,h);s(t)}return t(),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e,h]);var j=function(e,t,r,n){if(!e||!t)return null;for(var o={debug:{elements:{forward:[],backward:[]},strings:{forward:[],backward:[]}},asphalt:{elements:{forward:[],backward:[]},strings:{forward:[],backward:[]}},line:{elements:{striped:[],continous:[]},strings:{striped:[],continous:[]}},center:{},curb:{}},s={rotate:{strings:[]},lanes:{strings:{forward:{add:[],remove:[]},backward:{add:[],remove:[]}},elements:{forward:{},backward:{}}}},c={offsetBottom:function(e){return g(t,e.first)},offsetTop:function(e){return g(t,e.last)},halfRoadLeft:function(e){return b(t.roadWidth/2,e.angle-90)},halfRoadRight:function(e){return b(t.roadWidth/2,e.angle+90)},laneBottomLeft:function(e,t){return g(c.halfRoadLeft(t),c.offsetBottom(e))},laneTopLeft:function(e,t){return g(c.halfRoadLeft(t),c.offsetTop(e))},laneBottomRight:function(e,t){return g(c.halfRoadRight(t),c.offsetBottom(e))},laneTopRight:function(e,t){return g(c.halfRoadRight(t),c.offsetTop(e))},roadBottomLeft:function(e){return g(g(e.backward[0].first,t),c.halfRoadLeft(e))},roadBottomRight:function(e){return g(g(e.forward[e.forward.length-1].first,t),c.halfRoadRight(e))},roadTopLeft:function(e){return g(g(e.backward[0].last,t),c.halfRoadLeft(e))},roadTopRight:function(e){return g(g(e.forward[e.forward.length-1].last,t),c.halfRoadRight(e))},roadTopMiddle:function(e){return g(b(t.roadLength,e.angle),g(b((e.numberOfForward+e.numberOfBackward)*t.roadWidth/2,e.angle+90),c.roadBottomLeft(e)))}},i=function(){var r,d=h[m],i=Object(f.a)(e.entries());try{for(i.s();!(r=i.n()).done;){var w,p=Object(l.a)(r.value,2),j=p[0],O=p[1],x=Object(f.a)(O[d].entries());try{for(x.s();!(w=x.n()).done;){var v=Object(l.a)(w.value,2),y=v[0],k=v[1];o.asphalt.strings[d].push(u([{letter:"M",coords:[c.offsetBottom(k)]},{letter:"L",coords:[c.laneBottomLeft(k,O),c.laneTopLeft(k,O),c.laneTopRight(k,O),c.laneBottomRight(k,O)]},{letter:"Z"}])),o.debug.strings[d].push([c.offsetBottom(k),c.offsetTop(k)]),y===O[d].length-1&&"backward"!==d||(y===O[d].length-1&&"backward"===d?o.line.strings.continous.push([c.laneBottomRight(k,O),c.laneTopRight(k,O)]):o.line.strings.striped.push([c.laneBottomRight(k,O),c.laneTopRight(k,O)]))}}catch(B){x.e(B)}finally{x.f()}"backward"===d&&s.rotate.strings.push({vectors:c.roadTopMiddle(O),order:O.order}),0===j&&(o.center.string=u([{letter:"M",coords:[c.roadBottomLeft(O)]}])),o.center.string+=u([{letter:"L",coords:[c.roadBottomLeft(O),c.roadBottomRight(O)]}]),o.coordInfo=Object(a.jsx)("circle",{cx:t.x,cy:t.y,r:"5"}),0===j&&(o.curb.string=u([{letter:"M",coords:[c.roadBottomLeft(O)]}])),o.curb.string+=u([{letter:"L",coords:[c.roadBottomLeft(O),c.roadTopLeft(O)]},{letter:"M",coords:[c.roadTopRight(O)]},{letter:"L",coords:[c.roadBottomRight(O)]}]),j===e.length-1&&(o.curb.string+=u([{letter:"L",coords:[c.roadBottomLeft(e[0])]}])),o.asphalt.elements[d]=o.asphalt.strings[d].map((function(e,t){return Object(a.jsx)("path",{d:e,className:d+"-asphalt"},t)})),o.debug.elements[d]=o.debug.strings[d].map((function(e,t){return Object(a.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,className:d+"-debug"},t)})),o.line.elements.striped=o.line.strings.striped.map((function(e,t){return Object(a.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,className:d+"-line",strokeDasharray:"30, 60"},t)})),o.line.elements.continous=o.line.strings.continous.map((function(e,t){return Object(a.jsx)("line",{x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y,className:d+"-line"},t)})),"backward"===d&&(s.lanes.strings.forward.remove.push(g(c.roadBottomLeft(O),b(t.roadLength/3,O.angle))),s.lanes.strings.forward.add.push(g(c.roadBottomLeft(O),b(2*t.roadLength/3,O.angle))),s.lanes.strings.backward.remove.push(g(c.roadBottomRight(O),b(t.roadLength/3,O.angle))),s.lanes.strings.backward.add.push(g(c.roadBottomRight(O),b(2*t.roadLength/3,O.angle))),s.lanes.elements.forward.remove=s.lanes.strings.forward.remove.map((function(e,t){return Object(a.jsx)("circle",{cx:e.x,cy:e.y,r:"10",className:"add-lane",onClick:function(){return n(t,"Forward",-1)}},t)})),s.lanes.elements.forward.add=s.lanes.strings.forward.add.map((function(e,t){return Object(a.jsx)("circle",{cx:e.x,cy:e.y,r:"10",className:"add-lane",onClick:function(){return n(t,"Forward",1)}},t)})),s.lanes.elements.backward.remove=s.lanes.strings.backward.remove.map((function(e,t){return Object(a.jsx)("circle",{cx:e.x,cy:e.y,r:"10",className:"add-lane",onClick:function(){return n(t,"Backward",-1)}},t)})),s.lanes.elements.backward.add=s.lanes.strings.backward.add.map((function(e,t){return Object(a.jsx)("circle",{cx:e.x,cy:e.y,r:"10",className:"add-lane",onClick:function(){return n(t,"Backward",1)}},t)})))}}catch(B){i.e(B)}finally{i.f()}},m=0,h=["forward","backward"];m<h.length;m++)i();return o.center.element=Object(a.jsx)("path",{d:o.center.string,className:"center"}),o.curb.element=Object(a.jsx)("path",{d:o.curb.string,className:"curb"}),s.rotate.elements=s.rotate.strings.map((function(e,t){return Object(a.jsx)("circle",Object(d.a)({cx:e.vectors.x,cy:e.vectors.y,r:"10",className:"rotate"},r(e.order)),t)})),[o,s]}(function(e,t){var r=[];if(!(t&&t.roadLength&&t.roadWidth))return null;for(var a=0;a<e.length;a++){var n=e[a],o=(n.numberOfForward+n.numberOfBackward-1)*t.roadWidth/2;r[a]={forward:[],backward:[],maxDistance:o,angle:n.angle,order:n.order,numberOfForward:n.numberOfForward,numberOfBackward:n.numberOfBackward};for(var s=n.numberOfForward+n.numberOfBackward,c=0;c<s;c++){var d=g(b(o-c*t.roadWidth,n.angle-90),b(t.maxRoadWidth*t.roadWidth*.7,n.angle)),l=g(d,b(t.roadLength,n.angle));c>=n.numberOfForward?r[a].forward.push({first:d,last:l}):r[a].backward.push({first:d,last:l})}}return r}(h,o),o,p,(function(e,t,r){var a=h.map((function(e){return Object(d.a)({},e)}));(a[e]["numberOf"+t]>1||r>0)&&(a[e]["numberOf"+t]+=r),w(a)})),O=j||[null,null],x=Object(l.a)(O,2),v=x[0],y=x[1];return Object(a.jsx)("div",{style:{touchAction:"none"},children:Object(a.jsxs)("svg",{className:"artboard",ref:e,children:[v?v.asphalt.elements.forward:null,v?v.asphalt.elements.backward:null,v?v.center.element:null,v?v.curb.element:null,v?v.line.elements.continous:null,v?v.line.elements.striped:null,y?y.rotate.elements:null,y?y.lanes.elements.forward.remove:null,y?y.lanes.elements.forward.add:null,y?y.lanes.elements.backward.remove:null,y?y.lanes.elements.backward.add:null,v?null:Object(a.jsx)("text",{children:"Loading"})]})})}function b(e,t){var r=t*Math.PI/180;return{x:e*Math.cos(r),y:e*Math.sin(r)}}function g(e,t){return{x:e.x+t.x,y:e.y+t.y}}var h=r(40),w=r(79),p=r(80),j=r.p+"static/media/forward.fc55a6c4.svg",O=r.p+"static/media/give way.db0b54fd.svg",x=r.p+"static/media/left.1aa9e07d.svg",v=r.p+"static/media/right.ff8f1205.svg",y=r.p+"static/media/stop.4938481c.svg",k=r.p+"static/media/priority.1971fe2a.svg";function B(){var e=[j,O,x,v,y,k].map((function(e,t){return Object(a.jsx)(L,{src:e},t)}));return Object(a.jsx)("div",{className:"inventory",children:e})}function L(e){var t=Object(h.useSpring)((function(){return{x:0,y:0}})),r=Object(l.a)(t,2),n=r[0],o=n.x,s=n.y,c=r[1],f=Object(i.b)({onDrag:function(e){var t=e.down,r=Object(l.a)(e.movement,2),a=r[0],n=r[1];c({x:t?a:0,y:t?n:0})},onDragEnd:function(e){var t=e.tap;console.log(t)}},{filterTaps:!0}),u=Object(w.animated)(p.a);return Object(a.jsx)(u,Object(d.a)(Object(d.a)({className:"drag"},f()),{},{style:{x:o,y:s},children:Object(a.jsx)("img",{src:e.src,className:"sign",alt:e.src,draggable:!1})}))}function R(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(B,{}),Object(a.jsx)(m,{})]})}c.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(R,{})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.27ec3d05.chunk.js.map